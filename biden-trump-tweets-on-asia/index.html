<head>
    <style>
        .body {
            font-family: 'Helvetica', sans-serif;
        }

        h1 {
            font-family: 'Helvetica', sans-serif;
            font-size: xx-large;
            text-align: center;
            width: 100%;
            color: #34495e;
        }

        .tick text {
            font-size: larger;
        }

        .tooltip {
            overflow: hidden;
            opacity: 0;
            padding: 0.6em 1em;
            background: #fff;
            color: dimgray;
            max-width: 400px;
            max-height: 400px;
            text-align: left;
            line-height: 1.4em;
            font-family: 'Source Sans Pro', sans-serif;
            font-size: 1.5em;
            font-weight: bold;
            border: 2px solid #ddd;
            border-radius: 2px;
            z-index: 10;
            /* transition: all 0.1s ease-out; */
            pointer-events: none;
            padding: 5px 7px 5px 7px !important;
            font-size: 20px !important;
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 22px 28px 45px rgba(0, 0, 0, .25);
            transform: translate3D(0, 2px, 0);
        }

        #hero {
            width: 100%;
            height: auto;
        }

        button {
            font-size: large;
        }

        #biden {
            background-color: #0542f7;
            position: relative;
            left: 100px;
            bottom: 40px;
        }

        #reset {
            background-color: rgb(232, 232, 232);
            position: relative;
            left: 170px;
            bottom: 40px;
        }

        #trump {
            background-color: rgba(217, 42, 42, 0.8);
            position: relative;
            left: 240px;
            bottom: 40px;
        }
        #countries {
            background-color: rgb(113, 177, 113);
            position: relative;
            left: -140px;
            bottom: -10px;
        }

        #biden:hover {
            background-color: #b3b3b3;
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 22px 28px 45px rgba(0, 0, 0, .25);
            transform: translate3D(0, 2px, 0);
        }

        #reset:hover {
            background-color: #b3b3b3;
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 22px 28px 45px rgba(0, 0, 0, .25);
            transform: translate3D(0, 2px, 0);
        }

        #trump:hover {
            background-color: #b3b3b3;
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 22px 28px 45px rgba(0, 0, 0, .25);
            transform: translate3D(0, 2px, 0);
        }

        #countries:hover {
            background-color: #b3b3b3;
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 22px 28px 45px rgba(0, 0, 0, .25);
            transform: translate3D(0, 2px, 0);
        }

        #biden:focus {
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 5px 10px 12px rgba(0, 0, 0, .5);
            transform: translate3D(0, 2px, 0);
        }
        #trump:focus {
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 5px 10px 12px rgba(0, 0, 0, .5);
            transform: translate3D(0, 2px, 0);
        }
        #reset:focus {
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 5px 10px 12px rgba(0, 0, 0, .5);
            transform: translate3D(0, 2px, 0);
        }
        #countries:focus {
            transition-timing-function: ease-out;
            transition: 0.2s;
            box-shadow: 5px 10px 12px rgba(0, 0, 0, .5);
            transform: translate3D(0, 2px, 0);
        }

        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-gap: 20px;
        }

        #bidenCountries {
            margin: 100px;
        }


        #trumpCountries {
            margin: 100px;
        }

        #bidenIssues {
            margin: 100px;
        }


        #trumpIssues {
            margin: 100px;
        }

        svg.bubble {
            background-color: rgba(128, 128, 128, 0.1);
        }

        .twitter-timeline {
            margin: 200px;
        }

        #legend {
            position: relative;
            top: -10px;
            left: 220px;
            /* width: 100%;
            height: 100px; */
        }
    </style>
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<img src="ama-tweet-banner.png" alt="Biden vs Trump: A Year of Tweets on Asia" id="hero">
<div id="wrapper"></div>
<div id="tooltip" class="tooltip"></div>

<button id="biden">BIDEN</button>
<button id="reset">RESET</button>
<button id="trump">TRUMP</button>
<button id="countries">COUNTRIES</button>
<div id="legend"></div>
<h1>BIDEN VS TRUMP: TWEETS ON THE INDO-PACIFIC</h1>

<div class="grid-container">

    <div id="bidenCountries" class="grid1"></div>

    <!-- <div id="bidenCountries" class="grid1"></div> -->

    <div id="trumpCountries" class="grid2"></div>

    <!-- <div id="trumpCountries" class="grid2"></div> -->
</div>

<h1>BIDEN VS TRUMP: TWEETS ON ISSUES</h1>

<div class="grid-container">

    <div id="bidenIssues" class="grid1"></div>
    <div id="trumpIssues" class="grid2"></div>
</div>
<!-- <h1>LATEST TWEETS</h1>
<a class="twitter-timeline" href="https://twitter.com/JoeBiden" data-tweet-limit="1" data-width="399" ></a>
<script async src="http://platform.twitter.com/widgets.js" charset="utf-8"></script>
<a class="twitter-timeline" href="https://twitter.com/realDonaldTrump" data-tweet-limit="1" data-width="399" ></a>
<script async src="http://platform.twitter.com/widgets.js" charset="utf-8"></script> -->
<!-- <button id="byCountry">COUNTRY</button> -->

<body>
    <script>
        // Indo-Pacific countries to filter tweets 
        var conditions = ["Asia", "China", "Japan", "North Korea", "South Korea", "Mongolia", "Taiwan", "Hong Kong", "Brunei", "Cambodia", "Indonesia", "Laos", "Malaysia", "Myanmar", "Philippines", "Singapore", "Thailand", "Vietnam", "Timor-Leste", "Bangladesh", "Bhutan", "India", "Maldives", "Nepal", "Sri Lanka", "Oceania", "Australia", "Micronesia", "Fiji", "Kiribati", "Marshall Islands", "Nauru", "New Zealand", "Palau", "Papua New Guinea", "Samoa", "Solomon Islands", "Tonga", "Tuvalu", "Vanuatu"]

        var color2 = d3.scaleOrdinal()
            .domain(["Asia", "China", "North Korea", "Japan", "Hong Kong", "South Korea", "Taiwan", "India", "Vietnam", "Thailand", "Indonesia", "Malaysia", "Singapore", "Philippines", "Sri Lanka", "Australia", "New Zealand", "Samoa"])
            .range(["#384c5a", "#01aae9", "#dc3535", "#0ab493", "#EA899A", "#ed695a", "#996cb7", "#ff9459", "#800e2c", "#a3413c", "#969292", "#baca3e", "#119bf4", "#9B111E", "#E5BE01", "#A98307", "#F4A900", "#89AC76"])

        // Load tweet data
        const dataPromiseT = d3.json("./stdTrump1.json");
        const dataPromiseB = d3.json("./stdBiden1.json");
        Promise.all([dataPromiseT, dataPromiseB]).then(function (values) { // Filter for countries
            const tweetData = values[0].concat(values[1]).filter(
                obj => conditions.some(
                    country => obj.tweet.includes(country)
                )
            )
            ready(tweetData)
        });
        function ready(tweetData) {

        var color = function (person) {
                if (person === "Biden") return "#0542f7"
                return "rgba(217, 42, 42, 0.8)"
            }

            let dimensions = {
                width: window.innerWidth * 0.8, height: window.innerHeight * 0.9,
                margin: {
                    top: 50,
                    right: 15,
                    bottom: 60,
                    left: 100,
                },
            }
            dimensions.boundedWidth = dimensions.width - dimensions.margin.left
                - dimensions.margin.right
            dimensions.boundedHeight = dimensions.height - dimensions.margin.top
                - dimensions.margin.bottom

            const wrapper = d3.select("#wrapper")
                .append("svg")
                .attr("width", dimensions.width)
                .attr("height", dimensions.height)

            const bounds = wrapper.append("g")
                .style("transform", `translate(${dimensions.margin.left
                    }px, ${dimensions.margin.top
                    }px)`)


            // Text for axes
            bounds.append("text")
                .attr("x", dimensions.width / 2)
                .attr("y", dimensions.height - 60)
                .attr("fill", "#34495e")
                .style("font-family", "Helvetica")
                .style("font-size", "1.5em")
                .style('font-weight', "700")
                .style("text-anchor", "middle")
                .html("Election Year 2020")

            bounds.append("text")
                .attr("x", -250)
                .attr("y", dimensions.width - dimensions.width - 60)
                .attr("fill", "#34495e")
                .style("font-family", "Helvetica")
                .style("font-size", "1.5em")
                .style('font-weight', "700")
                .style("transform", "rotate(-90deg)")
                .style("text-anchor", "middle")
                .html("Retweets")

                // legend 
var legendContainer = d3.select("#legend").append("svg")
.attr("width", 1000)
.attr("height", 120)
// create a list of keys
var keys = [ "Asia", "Australia", "China", "Hong Kong", "India", "Indonesia", "Japan", "Malaysia", "New Zealand", "North Korea", "Philippines", "Samoa", "Singapore", "South Korea", "Sri Lanka", "Taiwan", "Thailand", "Vietnam"]

legendContainer.selectAll("dots")
    .data(keys)
    .enter()
    .append("circle")
    .attr("cx", function (d, i) { return 100 + i * 50 }) 
    .attr("cy", 5)
    .attr("r", 5)
    .style("fill", function(d) { return color2(d)})

    legendContainer.selectAll("countries")
    .data(keys)
    .enter()
    .append("text")
    .attr("y", function (d, i) { return -95 - i * 50 }) 
    .attr("x", 15)
    .attr("r", 7)
    .style("fill", function(d) { return color2(d)})
    .text(function (d) { return d })
    .style("font-family", "helvetica")
    .attr("transform", "rotate(90)")
    .attr("text-anchor", "left")

            var dateParser = d3.timeParse("%Y-%m-%d");

            // Initialize x and y accessor functions 
            const xAccessor = d => dateParser(d.date);
            const yAccessor = d => d.retweets;

            // Add X axis at zero point 
            var x = d3.scaleTime()
                .domain([0, 0])
                .range([0, 0]);
            bounds.append("g")
                .attr("class", "myXaxis") // Give a class to the X axis, to be able to call it later and modify it
                .attr("transform", "translate(0," + dimensions.boundedHeight + ")")
                .call(d3.axisBottom(x))
                .attr("opacity", "0")
            // Add Y axis
            var y = d3.scaleLinear()
                .domain(d3.extent(tweetData, yAccessor))
                .range([dimensions.boundedHeight, 0]);
            bounds.append("g")
                .call(d3.axisLeft(y));

            function drawDots(tweetData, color) {
                bounds.append("g")
                    .selectAll("dot")
                    .data(tweetData)
                    .enter()
                    .append("circle")
                    .attr("class", "dots")
                    .attr("cx", d => xScale(xAccessor(0)))//calls d fat arrow function with value of one element in the dataset 
                    .attr("cy", d => yScale(yAccessor(d)))

                    .attr("r", 5)
                    .attr("fill", d => color(d.person))
            }
            // function color(person) {
            //     if (person === "Biden") return "#0542f7"
            //     return "rgba(217, 42, 42, 0.8)"
            // }

            // New X axis at data points 
            x.domain(d3.extent(tweetData, xAccessor))
            x.range([0, dimensions.boundedWidth])
            bounds.select(".myXaxis")
                .transition()
                .duration(2000)
                .attr("opacity", "1")
                .call(d3.axisBottom(x));

            // Initialize x and y scale functions 
            const xScale = d3.scaleTime()
                .domain(d3.extent(tweetData, xAccessor))
                .range([0, dimensions.boundedWidth])
                .nice()

            const yScale = d3.scaleLinear()
                .domain(d3.extent(tweetData, yAccessor))
                .range([dimensions.boundedHeight, 0])
                .nice()

            const covidX = xScale(dateParser("2020-01-21"));

            bounds.append("rect")
                .attr("x", 0)
                .attr("y", 0)
                .attr("width", covidX)
                .attr("height", dimensions.boundedHeight)
                .style("fill", "gray")
                .style("opacity", 0.1)

            bounds.append("rect")
                .attr("x", covidX)
                .attr("y", 0)
                .attr("width", dimensions.boundedWidth - 250)
                .attr("height", dimensions.boundedHeight)
                .style("fill", "pink")
                .style("opacity", 0.1)

            bounds.append("line")
                .attr("x1", covidX)
                .attr("x2", covidX)
                .attr("y1", 0)
                .attr("y2", dimensions.boundedHeight)
                .style("stroke", "gray")
                .style("stroke-dasharray", ("3, 3"))
                .style("stroke-width", 1);

            // Text for axes
            bounds.append("text")
                .attr("x", covidX)
                .attr("y", dimensions.height - dimensions.height - 5)
                .attr("fill", "#34495e")
                .style("font-family", "Helvetica")
                .style("font-size", "1.2em")
                .style('font-weight', "700")
                .style("text-anchor", "start")
                .html("‣ 1.20.2019 FIRST COVID-19 CASE IN US")

            // var img = bounds.append("image")
            //     .attr('xlink:href', 'biden.svg')
            //     .selectAll("img")
            //     .data(tweetData)
            //     .enter()
            //     .append("img")
            //     .attr('width', 5)
            //     .attr('height', 5)
            //     .attr("x", function (d) { return xScale(xAccessor(d)); })
            //     .attr("y", function (d) { return yScale(yAccessor(d)); })


            drawDots(tweetData, color)

            bounds.selectAll("circle")
                .transition()
                .delay(function (d, i) { return (i * 4) })
                .duration(2000)
                .attr("cx", d => xScale(xAccessor(d)))//calls d fat arrow function with value of one element in the dataset 
                .attr("cy", d => yScale(yAccessor(d)))

            // Append Div for tooltip to SVG
            const tooltip = d3.select("body")
                .append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);

            // Mouse handlers 
            bounds.selectAll("circle")
                .on("mouseenter", onMouseEnter)
                .on("mouseleave", onMouseLeave)
            // Select tooltip  and  define  mouse function 
            // const tooltip = d3.select("#tooltip")
            function onMouseEnter(datum) {
                var tweet = datum.tweet;

                // Define x, y for rollover circles and tooltip 
                const x1 = xScale(xAccessor(datum))
                const y1 = yScale(yAccessor(datum))

                const dayDot = bounds.append("circle")
                    .attr("class", "tooltipDot")
                    .attr("cx", x1)
                    .attr("cy", y1)
                    .transition()
                    .duration(100)
                    .attr("r", 8)
                    .style("fill", "gray")
                    .style("pointer-events", "none")

                // Show tweets
                tooltip.html(tweet)
                    // .style("top", (event.pageY) + "px")
                    // .style("left", (event.pageX) + "px")
                    // Position tooltip 
                    .style("transform", `translate(`
                        + `calc( ${x1}px + 120px),`
                        + `calc(100% + ${y1}px - 3000px)`
                        + `)`)
                    .style("opacity", 1.0)
            }
            // Remove tweets
            function onMouseLeave() {
                d3.selectAll(".tooltipDot")
                    .transition()
                    .duration(200)
                    .remove()
                tooltip.style("opacity", 0)
            }

            // Click handlers for Biden/Trump filter views 
            d3.select("#biden").on("click", function () {
                d3.selectAll(".dots")
                    .filter(function (d) { return d.person === "Trump"; })
                    .style("opacity", "0")
                    .style("fill",)
            })

            d3.select("#trump").on("click", function () {
                d3.selectAll(".dots")
                    .filter(function (d) { return d.person === "Biden"; })
                    .style("opacity", "0")
            })

            d3.select("#countries").on("click", function () {
                d3.selectAll(".dots")
                // .style("fill", "green")
                    .style("fill", function (d) { return color2(d.countries[0]) });
            })


            d3.select("#reset").on("click", function () {
                d3.selectAll(".dots")
                    .style("opacity", "1.0")
                    .style("fill", function (d) { return color(d.person) });
                //     .style("fill", function (d) { if (d.person === "Biden") {return "#0542f7" } else {
                // return "rgba(217, 42, 42, 0.8)" }})
            })

        }

        // Biden Countries 
        const bidenCountries = {
            "children": [
                {
                    "Tag": "China",
                    "Count": 36
                },
                {
                    "Tag": "North Korea",
                    "Count": 5
                },
                {
                    "Tag": "Asia",
                    "Count": 1
                },
                {
                    "Tag": "Japan",
                    "Count": 1
                },
                {
                    "Tag": "Hong Kong",
                    "Count": 10
                },
                {
                    "Tag": "Taiwan",
                    "Count": 3
                },
                {
                    "Tag": "India",
                    "Count": 2
                },
                {
                    "Tag": "Vietnam",
                    "Count": 1
                },
                {
                    "Tag": "Malaysia",
                    "Count": 1
                },
                {
                    "Tag": "Singapore",
                    "Count": 1
                },
                {
                    "Tag": "Australia",
                    "Count": 2
                }
            ]
        };

        bidenCountries.children.forEach(element => {
            console.log(bidenCountries.children.Count);
        });
        // Diameter of invisible enclosing circle of OED word categories
        const diameter = 500;
        var color = d3.scaleOrdinal()
            .domain(["Asia", "China", "North Korea", "Japan", "Hong Kong", "South Korea", "Taiwan", "India", "Vietnam", "Thailand", "Indonesia", "Malaysia", "Singapore", "Philippines", "Sri Lanka", "Australia", "New Zealand", "Samoa"])
            .range(["#384c5a", "#01aae9", "#dc3535", "#0ab493", "#EA899A", "#ed695a", "#996cb7", "#ff9459", "#800e2c", "#a3413c", "#969292", "#baca3e", "#119bf4", "#9B111E", "#E5BE01", "#A98307", "#F4A900", "#89AC76"]);

        var bubble = d3.pack(bidenCountries)
            .size([diameter, diameter])
            .padding(1.5);
        // Enclosing circle
        var CategoriesSvg = d3.select("#bidenCountries")
            .append("svg")
            .attr("width", diameter)
            .attr("height", diameter)
            .attr("class", "bubble");

        var nodes = d3.hierarchy(bidenCountries)
            .sum(function (d) { return d.Count; });

        var node = CategoriesSvg.selectAll(".node")
            .data(bubble(nodes).descendants())
            .enter()
            .filter(function (d) {
                return !d.children;
            })
            .append("g")
            .attr("class", "node")
            .attr("transform", function (d) {
                return "translate(" + d.x + "," + d.y + ")";
            });
        // Size and color of bubbles 
        node.append("circle")
            .attr("r", function (d) {
                return d.r;
            })
            .style("fill", function (d) {
                return color(d.data.Tag);
            })

        // Bubble text is category tag 
        node.append("text")
            .attr("dy", ".05em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.Tag.substring(0, d.r / 2);
            })
            .attr("font-family", "'Montserrat', sans-serif")
            .attr("font-size", function (d) {
                return d.r / 6;
            })
            .attr("fill", "white")
            .attr('category', function (d) { return d.data.Tag })
            .attr("class", "category")
            .on('mouseover', catOver)
            .on('mouseout', catOut);
        // Text for category counts 
        node.append("text")
            .attr("dy", "1.0em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.Count;
            })
            .attr("font-family", "'Montserrat', sans-serif")
            .attr("font-size", function (d) {
                return d.r / 6;
            })
            .attr("fill", "white")

        d3.select("center").style("background-color", "white");

        CategoriesSvg.append("text")
            .attr("x", diameter / 2)
            .attr("y", diameter - 5)
            .attr("fill", "#34495e")
            .style("font-family", "Helvetica")
            .style("font-size", "1.2em")
            .style('font-weight', "700")
            .style("text-anchor", "middle")
            .html("BIDEN")

        // Trump Countries

        const trumpCountries = {
            "children": [
                {
                    "Tag": "China",
                    "Count": 623
                },
                {
                    "Tag": "North Korea",
                    "Count": 183
                },
                {
                    "Tag": "Asia",
                    "Count": 11
                },
                {
                    "Tag": "Japan",
                    "Count": 109
                },
                {
                    "Tag": "Hong Kong",
                    "Count": 8
                },
                {
                    "Tag": "South Korea",
                    "Count": 42
                },
                {
                    "Tag": "Taiwan",
                    "Count": 2
                },
                {
                    "Tag": "India",
                    "Count": 39
                },
                {
                    "Tag": "Vietnam",
                    "Count": 46
                },
                {
                    "Tag": "Thailand",
                    "Count": 3
                },
                {
                    "Tag": "Indonesia",
                    "Count": 2
                },
                {
                    "Tag": "Philippines",
                    "Count": 9
                },
                {
                    "Tag": "Singapore",
                    "Count": 18
                },
                {
                    "Tag": "Sri Lanka",
                    "Count": 6
                },
                {
                    "Tag": "Australia",
                    "Count": 11
                },
                {
                    "Tag": "New Zealand",
                    "Count": 7
                },
                {
                    "Tag": "Samoa",
                    "Count": 1
                }
            ]
        };

        var color = d3.scaleOrdinal()
            .domain(["Asia", "China", "North Korea", "Japan", "Hong Kong", "South Korea", "Taiwan", "India", "Vietnam", "Thailand", "Indonesia", "Malaysia", "Singapore", "Philippines", "Sri Lanka", "Australia", "New Zealand", "Samoa"])
            .range(["#384c5a", "#01aae9", "#dc3535", "#0ab493", "#EA899A", "#ed695a", "#996cb7", "#ff9459", "#800e2c", "#a3413c", "#969292", "#baca3e", "#119bf4", "#9B111E", "#E5BE01", "#A98307", "#F4A900", "#89AC76"]);

        var bubble = d3.pack(trumpCountries)
            .size([diameter, diameter])
            .padding(1.5);
        // Enclosing circle
        var CategoriesSvg = d3.select("#trumpCountries")
            .append("svg")
            .attr("width", diameter)
            .attr("height", diameter)
            .attr("class", "bubble");

        var nodes = d3.hierarchy(trumpCountries)
            .sum(function (d) { return d.Count; });

        var node = CategoriesSvg.selectAll(".node")
            .data(bubble(nodes).descendants())
            .enter()
            .filter(function (d) {
                return !d.children;
            })
            .append("g")
            .attr("class", "node")
            .attr("transform", function (d) {
                return "translate(" + d.x + "," + d.y + ")";
            });
        // Size and color of bubbles 
        node.append("circle")
            .attr("r", function (d) {
                return d.r;
            })
            .style("fill", function (d) {
                return color(d.data.Tag);
            })
        CategoriesSvg.append("text")
            .attr("x", diameter / 2)
            .attr("y", diameter - 5)
            .attr("fill", "#34495e")
            .style("font-family", "Helvetica")
            .style("font-size", "1.2em")
            .style('font-weight', "700")
            .style("text-anchor", "middle")
            .html("TRUMP")

        // Bubble text is category tag 
        node.append("text")
            .attr("dy", ".05em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.Tag.substring(0, d.r / 2);
            })
            .attr("font-family", "'Montserrat', sans-serif")
            .attr("font-size", function (d) {
                return d.r / 6;
            })
            .attr("fill", "white")
            .attr('category', function (d) { return d.data.Tag })
            .attr("class", "category")
            .on('mouseover', catOver)
            .on('mouseout', catOut);
        // Text for category counts 
        node.append("text")
            .attr("dy", "1.0em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.Count;
            })
            .attr("font-family", "'Montserrat', sans-serif")
            .attr("font-size", function (d) {
                return d.r / 6;
            })
            .attr("fill", "white")

        d3.select("center").style("background-color", "white");

        // Biden Issues
        const bidenIssues = {
            "children": [
                {
                    "Tag": "Alliance",
                    "Count": 8
                },
                {
                    "Tag": "Authoritarian",
                    "Count": 4
                },
                {
                    "Tag": "Climate Change",
                    "Count": 103
                },
                {
                    "Tag": "Cooperation",
                    "Count": 2
                },
                {
                    "Tag": "Democracy",
                    "Count": 79
                },
                {
                    "Tag": "Human Rights",
                    "Count": 32
                },
                {
                    "Tag": "Immigration",
                    "Count": 32
                },
                {
                    "Tag": "Liberal International Order",
                    "Count": 1
                },
                {
                    "Tag": "Military",
                    "Count": 38
                },
                {
                    "Tag": "Technology",
                    "Count": 4
                },
                {
                    "Tag": "Trade",
                    "Count": 33
                },
                {
                    "Tag": "Values",
                    "Count": 7
                },
            ]
        };

        bidenIssues.children.forEach(element => {
            console.log(bidenIssues.children.Count);
        });
        // Diameter of invisible enclosing circle of OED word categories

        var color = d3.scaleOrdinal()
            .domain(["Alliance", "Authoritarian", "Climate Change", "Cooperation", "Democracy", "Human Rights", "Immigration", "Liberal International Order", "Military", "South China Sea", "Technology", "TPP", "Trade", "Values"])
            .range(["#345290", "#237d6c", "#7f5d52", "#e2ad15", "#b89032", "#AF5556", "#61666c", "#cd2d32", "#6fbfbb", "#454c5a", "#a16d4d", "#e9804f", "#4f6762", "#4493c5"]);

        var bubble = d3.pack(bidenIssues)
            .size([diameter, diameter])
            .padding(1.5);
        // Enclosing circle
        var CategoriesSvg = d3.select("#bidenIssues")
            .append("svg")
            .attr("width", diameter)
            .attr("height", diameter)
            .attr("class", "bubble");

        var nodes = d3.hierarchy(bidenIssues)
            .sum(function (d) { return d.Count; });

        var node = CategoriesSvg.selectAll(".node")
            .data(bubble(nodes).descendants())
            .enter()
            .filter(function (d) {
                return !d.children;
            })
            .append("g")
            .attr("class", "node")
            .attr("transform", function (d) {
                return "translate(" + d.x + "," + d.y + ")";
            });
        // Size and color of bubbles 
        node.append("circle")
            .attr("r", function (d) {
                return d.r;
            })
            .style("fill", function (d) {
                return color(d.data.Tag);
            })


        // Bubble text is category tag 
        node.append("text")
            .attr("dy", ".05em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.Tag.substring(0, d.r / 2);
            })
            .attr("font-family", "'Montserrat', sans-serif")
            .attr("font-size", function (d) {
                return d.r / 6;
            })
            .attr("fill", "white")
            .attr('category', function (d) { return d.data.Tag })
            .attr("class", "category")
            .on('mouseover', catOver)
            .on('mouseout', catOut);
        // Text for category counts 
        node.append("text")
            .attr("dy", "1.0em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.Count;
            })
            .attr("font-family", "'Montserrat', sans-serif")
            .attr("font-size", function (d) {
                return d.r / 6;
            })
            .attr("fill", "white")

        d3.select("center").style("background-color", "white");

        CategoriesSvg.append("text")
            .attr("x", diameter / 2)
            .attr("y", diameter - 5)
            .attr("fill", "#34495e")
            .style("font-family", "Helvetica")
            .style("font-size", "1.2em")
            .style('font-weight', "700")
            .style("text-anchor", "middle")
            .html("BIDEN")
        // Trump Issues

        const trumpIssues = {
            "children": [
                {
                    "Tag": "Alliance",
                    "Count": 7
                },
                {
                    "Tag": "Climate Change",
                    "Count": 4
                },
                {
                    "Tag": "Cooperation",
                    "Count": 15
                },
                {
                    "Tag": "Democracy",
                    "Count": 32
                },
                {
                    "Tag": "Human Rights",
                    "Count": 6
                },
                {
                    "Tag": "Immigration",
                    "Count": 218
                },
                {
                    "Tag": "Military",
                    "Count": 548
                },
                {
                    "Tag": "South China Sea",
                    "Count": 1
                },
                {
                    "Tag": "TPP",
                    "Count": 4
                },
                {
                    "Tag": "Technology",
                    "Count": 21
                },
                {
                    "Tag": "Trade",
                    "Count": 441
                },
                {
                    "Tag": "Values",
                    "Count": 22
                },
            ]
        };

        var color = d3.scaleOrdinal()
            .domain(["Alliance", "Authoritarian", "Climate Change", "Cooperation", "Democracy", "Human Rights", "Immigration", "Liberal International Order", "Military", "South China Sea", "Technology", "TPP", "Trade", "Values"])
            .range(["#345290", "#237d6c", "#7f5d52", "#e2ad15", "#b89032", "#AF5556", "#61666c", "#cd2d32", "#6fbfbb", "#454c5a", "#a16d4d", "#e9804f", "#4f6762", "#4493c5"]);

        var bubble = d3.pack(trumpIssues)
            .size([diameter, diameter])
            .padding(1.5);
        // Enclosing circle
        var CategoriesSvg = d3.select("#trumpIssues")
            .append("svg")
            .attr("width", diameter)
            .attr("height", diameter)
            .attr("class", "bubble");

        var nodes = d3.hierarchy(trumpIssues)
            .sum(function (d) { return d.Count; });

        var node = CategoriesSvg.selectAll(".node")
            .data(bubble(nodes).descendants())
            .enter()
            .filter(function (d) {
                return !d.children;
            })
            .append("g")
            .attr("class", "node")
            .attr("transform", function (d) {
                return "translate(" + d.x + "," + d.y + ")";
            });
        // Size and color of bubbles 
        node.append("circle")
            .attr("r", function (d) {
                return d.r;
            })
            .style("fill", function (d) {
                return color(d.data.Tag);
            })


        // Bubble text is category tag 
        node.append("text")
            .attr("dy", ".05em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.Tag.substring(0, d.r / 2);
            })
            .attr("font-family", "'Montserrat', sans-serif")
            .attr("font-size", function (d) {
                return d.r / 6;
            })
            .attr("fill", "white")
            .attr('category', function (d) { return d.data.Tag })
            .attr("class", "category")
            .on('mouseover', catOver)
            .on('mouseout', catOut);
        // Text for category counts 
        node.append("text")
            .attr("dy", "1.0em")
            .style("text-anchor", "middle")
            .text(function (d) {
                return d.data.Count;
            })
            .attr("font-family", "'Montserrat', sans-serif")
            .attr("font-size", function (d) {
                return d.r / 6;
            })
            .attr("fill", "white")

        d3.select("center").style("background-color", "white");

        // Functions for mouseover and mouseout for category bubbles 
        function catOver(e) {
            d3.select(this).classed("active", true)
        }
        function catOut() {
            d3.select(this).classed("active", false)
        }

        CategoriesSvg.append("text")
            .attr("x", diameter / 2)
            .attr("y", diameter - 5)
            .attr("fill", "#34495e")
            .style("font-family", "Helvetica")
            .style("font-size", "1.2em")
            .style('font-weight', "700")
            .style("text-anchor", "middle")
            .html("TRUMP")


    </script>


</body>